@startuml
allowmixing
top to bottom direction
title Student Wellbeing Analytics â€“ System Architecture

skinparam packageStyle rectangle
skinparam componentStyle rectangle
skinparam ArrowColor #2D4059
skinparam defaultTextAlignment center
skinparam shadowing false

' ===================== Frontend =====================
package "Frontend" #A7C7E7 {
  component "Vue + Vite\n(Client UI)" as Frontend
}

' ===================== Flask Backend =====================
package "Flask Backend" #C5E1A5 {

  package "API Routing\n(Flask Blueprints)" #E8F5E9 {
    component "Auth Blueprint" as AuthBP
    component "Student Blueprint" as StudentBP
    component "Analysis Blueprint" as AnalysisBP
    component "Admin Blueprint" as AdminBP
  }

  package "Business Logic Layer\n(Repositories)" #FFF3CD {
    component "StudentRepository" as StudentRepo
    component "UserRepository" as UserRepo
    component "ModuleRepository" as ModuleRepo
    component "EnrolmentRepository" as EnrolRepo
    component "SurveyResponseRepository" as SurveyRepo
    component "AttendanceRecordRepository" as AttendanceRepo
    component "SubmissionRecordRepository" as SubmissionRepo
    component "GradeRepository" as GradeRepo
    component "StressEventRepository" as StressEventRepo
    component "AlertRepository" as AlertRepo
    component "AnalysisRepository" as AnalysisRepo
  }

  package "Domain Layer\n(Models)" #FDEBD0 {
    component "Entity Models" as Models
  }

  package "Infrastructure\n(DB Access)" #FFCDD2 {
    component "db_connection\n(SQLite connector)" as DBConn
  }
}

' ===================== Database =====================
database "SQLite Database" as SQLiteDB

' -------- Frontend -> Blueprints --------
Frontend --> AuthBP
Frontend --> StudentBP
Frontend --> AnalysisBP
Frontend --> AdminBP

' -------- Blueprints -> Repositories --------
AuthBP --> StudentRepo
AuthBP --> UserRepo

StudentBP --> StudentRepo
StudentBP --> UserRepo

AnalysisBP --> AnalysisRepo
AnalysisBP --> StudentRepo

AdminBP --> ModuleRepo
AdminBP --> EnrolRepo
AdminBP --> SurveyRepo
AdminBP --> AttendanceRepo
AdminBP --> SubmissionRepo
AdminBP --> GradeRepo
AdminBP --> StressEventRepo
AdminBP --> AlertRepo
AdminBP --> UserRepo
AdminBP --> StudentRepo

' -------- Repositories -> DB Connection --------
StudentRepo --> DBConn
UserRepo --> DBConn
ModuleRepo --> DBConn
EnrolRepo --> DBConn
SurveyRepo --> DBConn
AttendanceRepo --> DBConn
SubmissionRepo --> DBConn
GradeRepo --> DBConn
StressEventRepo --> DBConn
AlertRepo --> DBConn
AnalysisRepo --> DBConn

DBConn --> SQLiteDB

' -------- Models used by Repositories and Blueprints --------
StudentRepo ..> Models
UserRepo ..> Models
ModuleRepo ..> Models
EnrolRepo ..> Models
SurveyRepo ..> Models
AttendanceRepo ..> Models
SubmissionRepo ..> Models
GradeRepo ..> Models
StressEventRepo ..> Models
AlertRepo ..> Models
AnalysisRepo ..> Models

AuthBP ..> Models
StudentBP ..> Models
AnalysisBP ..> Models
AdminBP ..> Models

@enduml